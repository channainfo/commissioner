<div class="card-body calculator-fields py-0">
  <div class="row">
    <div class="form-group col m-0 ml-0">
      <% field_name = "#{param_prefix}[calculator_type]" %>
      <%= label_tag field_name, Spree.t(:calculator) %>
      <%= select_tag field_name,
                     options_from_collection_for_select(pricing_action.available_calculators, :to_s, :description, pricing_action.calculator&.type),
                     class: 'type-select select2' %>
    </div>

    <% if pricing_action.calculator.present? %>
      <div class="form-group col m-0 mr-0">
        <% type_name = pricing_action.calculator.type.demodulize.underscore %>

        <% if lookup_context.exists?("fields", ["spree/admin/promotions/calculators/#{type_name}"], true) %>
          <%= render "spree/admin/promotions/calculators/#{type_name}/fields", calculator: pricing_action.calculator, prefix: param_prefix %>
        <% else %>
          <%= render "spree/admin/promotions/calculators/default_fields", calculator: pricing_action.calculator, prefix: param_prefix %>
        <% end %>

        <%= hidden_field_tag "#{param_prefix}[calculator_attributes][id]", pricing_action.calculator.id %>
      </div>
    <% end %>
  </div>

  <% if pricing_action.calculator == nil || pricing_action.calculator.preferences.empty? %>
    <div class="alert alert-info js-warning mt-3 mb-0">
      <%= Spree.t(:calculator_settings_warning) %>
    </div>
  <% end %>
</div>
