<div class="table-responsive border rounded bg-white">
  <table class="table sortable" data-sortable-link="<%= update_positions_admin_product_pricing_rates_path(@product) %>">
    <thead class="text-muted">
      <tr data-hook="variant_pricing_rates_header">
        <th></th>
        <th scope="col" class="text-center"><%= Spree.t(:name) %></th>
        <th scope="col" class="text-center"><%= Spree.t(:rules) %></th>
        <th scope="col" class="text-center"><%= Spree.t(:match_policy) %></th>
        <th scope="col" class="text-center"><%= Spree.t(:effective_from) %></th>
        <th scope="col" class="text-center"><%= Spree.t(:effective_to) %></th>
        <th scope="col" class="text-center" style="min-width: 150px;"><%= Spree.t(:price) %></th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody data-hook="variant_pricing_rates_body">
      <% @pricing_rates.each do |pricing_rate| %>
        <% price = pricing_rate.price_in(params[:currency]) %>
        <tr id="<%= spree_dom_id pricing_rate %>" data-hook="variant_pricing_rates_row">
          <td class="move-handle inline">
            <%= svg_icon name: "grip-vertical.svg", width: '18', height: '18' %>
          </td>
          <td class="text-center">
            <%= link_to edit_admin_product_pricing_rate_path(pricing_rate) do %>
              <%= pricing_rate.name %>
            <% end %>
          </td>
          <td>
            <ul class="m-0">
              <% pricing_rate.pricing_rules.each do |rule| %>
                <li class="py-1 px-2"><%= rule.description %></li>
              <% end %>
            </ul>
          </td>
          <td class="text-center">
            <p class="badge badge-secondary border bg-light m-0 text-dark" data-toggle="tooltip" data-placement="top" title='<%= Spree.t("pricing_rate.match_#{pricing_rate.match_policy}") %>'>
              <span class="align-middle"><%= pricing_rate.match_policy %></span>
              <%= svg_icon name: "info-circle.svg", width: '14', height: '14' %>
            </p>
          </td>
          <td class="text-center"><%= pretty_date(pricing_rate.effective_from) if pricing_rate.effective_from.present? %></td>
          <td class="text-center"><%= pretty_date(pricing_rate.effective_to) if pricing_rate.effective_to.present? %></td>
          <td class="text-center">
            <%= hidden_field_tag "pricing_rates[][id]", pricing_rate.id %>
            <%= text_field_tag "pricing_rates[][price]", price&.display_amount&.money, class: 'form-control' %>
          </td>
          <td class="actions">
            <span class="d-flex justify-content-end">
              <%= link_to_edit(pricing_rate, no_text: true) %>
              <%= link_to_with_icon('bricks.svg', Spree.t(:rules), admin_product_pricing_rules_path(pricing_rate_id: pricing_rate.id), class: 'btn btn-light btn-sm', no_text: true) %>
              <%= link_to_delete(pricing_rate, no_text: true) %>
            </span>
          </td>
        </tr>
      <% end %>

      <%# default rate %>
      <% price = @variant.price_in(params[:currency]) %>
      <tr id="variant_pricing_rates_row" data-hook="variant_pricing_rates_row">
        <td class="move-handle inline"><%= svg_icon name: "grip-vertical.svg", width: '18', height: '18' %></td>
        <td class="text-center">Default Rate</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>
          <%= text_field_tag "default_rate_price", price&.display_amount&.money, class: 'form-control' %>
        </td>
        <td class="actions"></td>
      </tr>
    </tbody>
  </table>
</div>
